{"version":3,"sources":["../../src/__tests__/Actions-test.js"],"names":[],"mappings":"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","file":"src/__tests__/Actions-test.js","sourcesContent":["import { Flux, Actions } from '../Flux';\nimport sinon from 'sinon';\n\ndescribe('Actions', () => {\n\n  class TestActions extends Actions {\n    getFoo() {\n      return { foo: 'bar' };\n    }\n\n    getBar() {\n      return { bar: 'baz' };\n    }\n\n    getBaz() {\n      return;\n    }\n\n    async asyncAction(returnValue) {\n      return returnValue;\n    }\n\n    badAsyncAction() {\n      return Promise.reject(new Error('some error'));\n    }\n  }\n\n  describe('#getActionIds / #getConstants', () => {\n    it('returns strings corresponding to action method names', () => {\n      const actions = new TestActions();\n\n      const actionIds = actions.getActionIds();\n\n      expect(actionIds.getFoo).to.be.a('string');\n      expect(actionIds.getBar).to.be.a('string');\n\n      expect(actionIds.getFoo).to.be.a('string');\n      expect(actionIds.getBar).to.be.a('string');\n    });\n\n  });\n\n  describe('#[methodName]', () => {\n    it('calls Flux dispatcher', () => {\n      const actions = new TestActions();\n\n      // Attach mock flux instance\n      const dispatch = sinon.spy();\n      actions.dispatch = dispatch;\n\n      actions.getFoo();\n      expect(dispatch.firstCall.args[1]).to.deep.equal({ foo: 'bar' });\n    });\n\n    it('warns if actions have not been added to a Flux instance', () => {\n      const actions = new TestActions();\n      const warn = sinon.spy(console, 'warn');\n\n      actions.getFoo();\n\n      expect(warn.firstCall.args[0]).to.equal(\n        'You\\'ve attempted to perform the action TestActions#getFoo, but it '\n      + 'hasn\\'t been added to a Flux instance.'\n      );\n\n      actions.asyncAction();\n\n      expect(warn.secondCall.args[0]).to.equal(\n        `You've attempted to perform the asynchronous action `\n      + `TestActions#asyncAction, but it hasn't been added `\n      + `to a Flux instance.`\n      );\n\n      console.warn.restore();\n    });\n\n    it('sends return value to Flux dispatch', () => {\n      const actions = new TestActions();\n      const actionId = actions.getActionIds().getFoo;\n      const dispatch = sinon.spy();\n      actions.dispatch = dispatch;\n\n      actions.getFoo();\n\n      expect(dispatch.firstCall.args[0]).to.equal(actionId);\n      expect(dispatch.firstCall.args[1]).to.deep.equal({ foo: 'bar' });\n    });\n\n    it('send async return value to Flux#dispatchAsync', async function() {\n      const actions = new TestActions();\n      const actionId = actions.getActionIds().asyncAction;\n      const dispatch = sinon.stub().returns(Promise.resolve());\n      actions.dispatchAsync = dispatch;\n\n      const response = actions.asyncAction('foobar');\n\n      expect(response.then).to.be.a('function');\n\n      await response;\n\n      expect(dispatch.firstCall.args[0]).to.equal(actionId);\n      expect(dispatch.firstCall.args[1]).to.be.an.instanceOf(Promise);\n    });\n\n    it('skips disptach if return value is undefined', () => {\n      const actions = new TestActions();\n      const dispatch = sinon.spy();\n      actions.dispatch = dispatch;\n\n      actions.getBaz();\n\n      expect(dispatch.called).to.be.false;\n    });\n\n    it('does not skip async dispatch, even if resolved value is undefined', () => {\n      const actions = new TestActions();\n      const dispatch = sinon.stub().returns(Promise.resolve(undefined));\n      actions.dispatchAsync = dispatch;\n\n      actions.asyncAction();\n\n      expect(dispatch.called).to.be.true;\n    });\n\n    it('returns value from wrapped action', async function() {\n      const flux = new Flux();\n      const actions = flux.createActions('test', TestActions);\n\n      expect(actions.getFoo()).to.deep.equal({ foo: 'bar' });\n      await expect(actions.asyncAction('async result'))\n        .to.eventually.equal('async result');\n    });\n\n  });\n\n});\n"]}